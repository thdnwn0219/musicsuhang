<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Suhang - 수행곡 연속재생</title>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Pretendard', sans-serif;
            background: linear-gradient(135deg, #f5f1e8, #e8ddd4);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            text-align: center;
            padding: 30px 20px 20px;
            background: linear-gradient(135deg, #2c1810, #8b4513);
            color: white;
        }

        .year-text {
            font-size: 14px;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .logo-container {
            margin: 20px 0;
        }

        .logo-img {
            max-width: 100%;
            height: auto;
            max-height: 80px;
        }

        .subtitle {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 18px;
            font-weight: 500;
            margin-top: 20px;
        }

        .main-content {
            padding: 30px;
        }

        .section-title {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 30px;
            color: #2c1810;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .control-btn {
            flex: 1;
            min-width: 120px;
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            font-family: 'Pretendard', sans-serif;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .control-btn.active {
            background: #2c1810;
            color: white;
        }

        .control-btn:not(.active) {
            background: #e0e0e0;
            color: #666;
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .player-section {
            background: #f8f8f8;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .current-song {
            text-align: center;
            margin-bottom: 25px;
        }

        .song-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .song-card.flipping {
            transform: rotateY(180deg);
        }

        .song-card.hidden {
            background: linear-gradient(135deg, #ddd, #bbb);
            color: #666;
        }

        .song-title {
            font-size: 18px;
            font-weight: 600;
            color: #2c1810;
        }

        .song-title.hidden-text {
            color: #888;
            font-style: italic;
        }

        .audio-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 20px;
        }

        .play-btn {
            background: #2c1810;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .play-btn:hover {
            background: #8b4513;
            transform: scale(1.1);
        }

        .progress-container {
            flex: 1;
            height: 6px;
            background: #ddd;
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: #2c1810;
            width: 0%;
            transition: width 0.1s ease;
        }

        .time-display {
            font-size: 14px;
            color: #666;
            min-width: 45px;
            text-align: center;
        }

        .playlist {
            margin-top: 20px;
        }

        .playlist-item {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .playlist-item:hover {
            background: #f0f0f0;
            transform: translateX(5px);
        }

        .playlist-item.active {
            background: #2c1810;
            color: white;
        }

        .track-number {
            background: #e0e0e0;
            color: #666;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 600;
        }

        .playlist-item.active .track-number {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .bottom-text {
            text-align: center;
            padding: 20px;
            font-size: 24px;
            font-weight: 600;
            color: #2c1810;
        }

        .made-by {
            text-align: center;
            padding: 20px;
            font-size: 14px;
            color: #666;
            background: #f8f8f8;
        }

        audio {
            display: none;
        }

        @keyframes flip {
            0% { transform: rotateY(0deg); }
            50% { transform: rotateY(90deg); }
            100% { transform: rotateY(0deg); }
        }

        .flipping {
            animation: flip 0.6s ease-in-out;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="year-text">2025년 서양음악사 + 감상 수행평가</div>
            <div class="logo-container">
                <img src="./images/musicsuhang-logo.png" alt="musicsuhang" class="logo-img">
            </div>
            <div class="subtitle">수행곡 연속재생</div>
        </div>

        <div class="main-content">
            <div class="section-title">노래재목</div>
            
            <div class="controls">
                <button class="control-btn active" id="sequentialBtn">재생</button>
                <button class="control-btn" id="pauseBtn">정지 ×</button>
                <button class="control-btn" id="randomBtn">랜덤재생</button>
            </div>

            <div class="player-section">
                <div class="current-song">
                    <div class="song-card" id="songCard">
                        <div class="song-title" id="songTitle">재생할 곡을 선택하세요</div>
                    </div>
                    
                    <div class="audio-controls">
                        <button class="play-btn" id="playPauseBtn">▶</button>
                        <div class="progress-container" id="progressContainer">
                            <div class="progress-bar" id="progressBar"></div>
                        </div>
                        <div class="time-display" id="timeDisplay">0:00</div>
                    </div>
                </div>

                <div class="playlist" id="playlist">
                    <!-- 플레이리스트 항목들이 여기에 동적으로 추가됩니다 -->
                </div>
            </div>
        </div>

        <div class="bottom-text">
            버그나 문제 오류있으면<br>알려주세요
        </div>

        <div class="made-by">
            made by 소현성
        </div>
    </div>

    <audio id="audioPlayer"></audio>

    <script>
        // 여기에 GitHub 폴더의 음악 파일 목록을 입력하세요
        const musicFiles = [
            '1. 고대 - 세이킬로스의 노래.mp3',
            '2. 중세 - 그레고리오 성가의 키리에.mp3', 
            '3. 르네상스 - 조스캥의 아베마리아.mp3',
            '4. 르네상스 - 팔레스트리나의 마르첼로 미사 중 제5곡 아뉴스 데이 Ⅰ.mp3',
            '5. 바로크 - 비발디 사계 中 봄 1악장 Allegro.mp3'
            '6. 바로크 - 바흐의 토카타와 푸가 라단조.mp3'
            '7. 바로크 - 헨델의 메시아 中 할렐루야.mp3'
            '8. 고전주의 - 하이든의 놀람 교향곡 중 2악장.mp3'
            '9. 고전주의 - 모차르트의 호른 협주곡 제2번 중 3악장.mp3'
            '10. 고전주의 - 베토벤의 월광 소나타 중 1악장.mp3'
            '11. 낭만주의 - 슈베르트의 겨울 나그네 중 제5번 보리수.mp3'
            // 실제 파일명으로 교체하세요
        ];

        let currentMode = 'sequential';
        let currentTrack = 0;
        let isPlaying = false;
        let isRandomMode = false;
        let revealedCards = new Set();

        const audioPlayer = document.getElementById('audioPlayer');
        const songCard = document.getElementById('songCard');
        const songTitle = document.getElementById('songTitle');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const progressBar = document.getElementById('progressBar');
        const timeDisplay = document.getElementById('timeDisplay');
        const playlist = document.getElementById('playlist');

        // 버튼 참조
        const sequentialBtn = document.getElementById('sequentialBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const randomBtn = document.getElementById('randomBtn');

        // 플레이리스트 생성
        function createPlaylist() {
            playlist.innerHTML = '';
            musicFiles.forEach((file, index) => {
                const item = document.createElement('div');
                item.className = 'playlist-item';
                item.innerHTML = `
                    <div class="track-number">${index + 1}</div>
                    <div>${removeTrackNumber(file)}</div>
                `;
                item.addEventListener('click', () => playTrack(index));
                playlist.appendChild(item);
            });
        }

        // 트랙 번호 제거 함수
        function removeTrackNumber(filename) {
            return filename.replace(/^\d+\.\s*/, '').replace(/\.[^/.]+$/, '');
        }

        // 트랙 재생
        function playTrack(index) {
            currentTrack = index;
            const file = musicFiles[index];
            audioPlayer.src = file; // 상대경로 사용
            
            updateSongDisplay();
            updatePlaylistHighlight();
            
            if (currentMode !== 'pause') {
                audioPlayer.play().catch(e => {
                    console.error('재생 오류:', e);
                    alert('음악 파일을 불러올 수 없습니다. 파일 경로를 확인해주세요.');
                });
                isPlaying = true;
                playPauseBtn.textContent = '⏸';
            }
        }

        // 송 디스플레이 업데이트
        function updateSongDisplay() {
            const filename = musicFiles[currentTrack];
            const cleanTitle = removeTrackNumber(filename);
            
            if (isRandomMode && !revealedCards.has(currentTrack)) {
                songTitle.textContent = '? ? ?';
                songTitle.className = 'song-title hidden-text';
                songCard.className = 'song-card hidden';
            } else {
                songTitle.textContent = cleanTitle;
                songTitle.className = 'song-title';
                songCard.className = 'song-card';
            }
        }

        // 플레이리스트 하이라이트 업데이트
        function updatePlaylistHighlight() {
            const items = playlist.querySelectorAll('.playlist-item');
            items.forEach((item, index) => {
                item.classList.toggle('active', index === currentTrack);
            });
        }

        // 카드 클릭 (랜덤 모드에서 제목 공개)
        songCard.addEventListener('click', () => {
            if (isRandomMode && !revealedCards.has(currentTrack)) {
                songCard.classList.add('flipping');
                setTimeout(() => {
                    revealedCards.add(currentTrack);
                    updateSongDisplay();
                    songCard.classList.remove('flipping');
                }, 300);
            }
        });

        // 재생/일시정지 버튼
        playPauseBtn.addEventListener('click', () => {
            if (currentMode === 'pause') return;
            
            if (isPlaying) {
                audioPlayer.pause();
                playPauseBtn.textContent = '▶';
            } else {
                audioPlayer.play();
                playPauseBtn.textContent = '⏸';
            }
            isPlaying = !isPlaying;
        });

        // 모드 버튼들
        sequentialBtn.addEventListener('click', () => {
            setMode('sequential');
        });

        pauseBtn.addEventListener('click', () => {
            setMode('pause');
        });

        randomBtn.addEventListener('click', () => {
            setMode('random');
        });

        function setMode(mode) {
            currentMode = mode;
            isRandomMode = mode === 'random';
            
            // 버튼 활성화 상태 업데이트
            document.querySelectorAll('.control-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            if (mode === 'sequential') {
                sequentialBtn.classList.add('active');
            } else if (mode === 'pause') {
                pauseBtn.classList.add('active');
                audioPlayer.pause();
                isPlaying = false;
                playPauseBtn.textContent = '▶';
            } else if (mode === 'random') {
                randomBtn.classList.add('active');
                revealedCards.clear();
            }
            
            updateSongDisplay();
        }

        // 오디오 이벤트 리스너
        audioPlayer.addEventListener('timeupdate', () => {
            const progress = (audioPlayer.currentTime / audioPlayer.duration) * 100;
            progressBar.style.width = progress + '%';
            
            const minutes = Math.floor(audioPlayer.currentTime / 60);
            const seconds = Math.floor(audioPlayer.currentTime % 60);
            timeDisplay.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
        });

        audioPlayer.addEventListener('ended', () => {
            if (currentMode === 'pause') return;
            
            if (isRandomMode) {
                // 랜덤 모드: 무작위 곡 선택
                currentTrack = Math.floor(Math.random() * musicFiles.length);
            } else {
                // 순차 재생 모드: 다음 곡으로 이동 (마지막 곡이면 첫 곡으로)
                currentTrack = (currentTrack + 1) % musicFiles.length;
            }
            
            playTrack(currentTrack);
        });

        // 진행 바 클릭으로 시간 이동
        document.getElementById('progressContainer').addEventListener('click', (e) => {
            const rect = e.currentTarget.getBoundingClientRect();
            const clickX = e.clientX - rect.left;
            const percentage = clickX / rect.width;
            audioPlayer.currentTime = audioPlayer.duration * percentage;
        });

        // 초기화
        createPlaylist();
        updateSongDisplay();
    </script>
</body>
</html>
